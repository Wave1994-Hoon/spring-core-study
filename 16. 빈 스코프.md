## 빈 스코프
#### 빈 스코프란 
- 스코프: 빈이 존재할 수 있는 범위

#### 스프링에서 지원하는 스코프
- 싱글톤
- 프로토타입
- 웹 관련 스코프
    - request
    - session
    - application
    

#### 프로토타입
- `@Scope("prototype")` 으로 지정 가능
- 프로토타입은 클라이언트가 스프링 컨테이너에 요청을 보내면 항상 새로운 인스턴스를 생성해서 반환한다.
- 즉 스프링 컨테이너는 프로토타입 빈을 생성하고, 의존관계 주입, 초기화까지만 처리한다. 그 이후는 관여하지 않는다.
- 따라서 `@PreDestory` 같은 종료 메서드가 호출되지 않는다.

#### 프로토타입 - 싱글톤과 함계 사용 시 문제점
- 만약 싱글톤 빈이 생성 시점에 프로토타입 빈을 주입 받는다면 ?
    - 프로토타입 빈에게 요청을 보내면 매번 새로운 빈을 생성하는게 아니라 싱글톤 처럼 동작을 한다.
    - 해당 이슈는 ObjectProvider 혹은 JSR-330 Provider를 사용하여 해결할 수 있다. 

#### 웹 스코프 
- 특징
    - 웹 환경에서만 동작
    - 스프링이 해당 스코프의 종료시점까지 관리, 따라서 종료 메서드 호출
- 종류
    - request: HTTP 요청 하나가 들어오고 나갈 때 까지 유지되는 스코프, 각각의 HTTP 요청마다 별도 인스턴스 생성 및 관리
        - 동시에 여러 HTTP 요청이 오면 정확히 어떤 요청이 남긴 로그인지 구분 어려움, 이때 사용하면 좋음 
        - 하지만 실제로 사용하다보면 싱글톤 빈은 어플리케이션 실행 시점에 생성해서 주입이 가능하지만 request 스코프는 주입 불가능
        - 따라서 Provider를 사용하면 해결 가능, 빈 생성 지연 
        - 혹은 프록시로 해결가능 
            - CGLIB 라이브러리로 내 클래스를 상속 받은 가짜 프록시 객체 생성해서 주입
            - 이 가짜 프록시 객체는 실제 요청이 오면 그떄 내부에서 실제 빈을 요청하는 위임 로직 들어감
    - session: HTTP Session과 동일한 생명주기를 가지는 스코프
    - application: 서블릿 컨텍스트와 동일한 생명주기를가지는 스코프 
    - websocket: 웹 소켓과 동일한 생명주기를 가지는 스코프 
