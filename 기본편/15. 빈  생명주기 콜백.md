## 빈 생명주기 콜백

#### 스프링 빈 라이프 사이클
- 객체 생성 -> 의존관계 주입 
- 생성자 주입은 예외, 객체가 생성도리 떄 생성자도 같이 호출되기 떄문에 
- 스프링 빈은 객체를 생성하고, 의존관계 주입이 다 끝난 다음에야 필요한 데이터를 사용할 수 있는 준비가 완료
- 초기화 작업(처음 일을 하는 작업) 의존관계 주입이 모두 완료되고 난 다음에 호출

#### 스프링 빈의 이벤트 라이프사이클(싱글턴)
- 스프링 컨테이너 생성 -> 스프링 빈 생성 -> 의존관계 주입(생성자 주입 x) -> 초기화 콜백 -> 사용 -> 소멸 전 콜백 -> 스프링 종료 
- 초기화 콜백: 빈이 생성되고, 빈의 의존관계 주입이 완료된 후 호출
- 소멸전 콜백: 빈이 소멸되기 직전에 호출 

#### 참고
- 객체의 생성과 초기화를 분리
    - 생성자는 필수 정보(파라미터)를 받고, 메모리를 할당해서 객체를 생성하는 책임을 갖는다.
    - 초기화는 이렇게 생성된 값들을 활용해서 외부 커넥션을 연결하는 등 무거운 동작 수행
    - 따라서 둘을 명확하게 나누는 것이 중요
    
#### 스프링 콜백
- 인터페이스 (거의 사용 안함)
    - `implement initializingBean`: 실행
    - `implement DisposableBean`: 종료
    - 단점
        - 이 인터페이스는 스프링 전용 인터페이스이다. 즉 스프링에 의존적이다.
        - 초기화, 소멸 메서드의 이름을 변경할 수 없다.
        - 내가 코드를 고칠 수 없는 외부 라이브러리에 적용 못함 
- 설정 정보에 초기화 메서드, 종료 메서드 지정
    - `@Bean(initMethod = "init", destroyMethod = "close")`
    - init 이라는 메서드와 close라는 메서드를 정의하고 빈 설정으로 등록 
    - 장점
        - 메서드 이름을 자유롭게 줄 수 있음
        - 스프링 빈이 스프링 코드에 의존하지 않음
        - 코드가 아니라 설정 정보를 사용하기 때문에 코드를 고칠 수 없는 외부 라이브러리에에도 적용 가능 
    - destroyMethod의 추가 기능
        - @Bean의 `destroyMethod`는 기본 값이 `(inferred)` 추론으로 등록
        - 이 추론 기능은 `close`, `shutdown` 라는 이름의 메서드를 자동으로 호출
        - 대부분의 라이브러리의 종료 메서드의 이름은 `close`, `shutdown`
        - 따라서 직접 스프링 빈으로 등록하면 종료 메서드는 따로 적어주지 않아도 동작
        - 하지만 이게 싫다면 `destroyMethod =""` 공백으로 설정
- @PostConstruct, @PreDestroy 애노테이션 지원 
    - 해당 방법을 권장 
    - 패지키가 javax 로 시작 --> 스프링이 컨테이너가 아니여도 사용 가능 
    - 단점
        - 외부라이브러리에는 적용 못함 -> 코드를 고쳐야되기 때문에 ....

